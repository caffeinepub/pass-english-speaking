{
  "kind": "build_request",
  "title": "Fix repetitive Gemini/AI chat replies and add English Learning Companion persona with Hindi/Hinglish support",
  "projectName": "English Learning Companion",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Eliminate the repetitive reply pattern in the AI/Friend/Teacher chat so the assistant does not keep responding with variations of â€œCool! Can you tell me moreâ€¦â€ for most user messages, especially short messages and questions.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6",
          "msg-7"
        ],
        "quotes": [
          "Fix the Gemini API behavior. The AI is repeating 'Cool! Can you tell me more' for every message.",
          "Personality Check: Make sure 'Friend Mode' is funny and 'Teacher Mode' is helpful, not repetitive."
        ]
      },
      "acceptanceCriteria": [
        "In Friend Chat, sending multiple short messages (e.g., â€œOkâ€, â€œNiceâ€, â€œHmmâ€, â€œWhy?â€) results in varied, non-repetitive responses that are not all requests to â€œtell me moreâ€.",
        "Teacher mode responses are actionable/helpful (e.g., corrections, suggested phrasing, a clarifying question) rather than generic prompts.",
        "The exact phrase â€œCool! ğŸ˜ Can you tell me more about that?â€ is no longer used as the default catch-all for short messages."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Update the AI assistantâ€™s system/persona instructions (used by the chat reply generation logic) so the assistant consistently presents itself as an â€œEnglish Learning Companionâ€ and prioritizes English-learning help (corrections, examples, vocabulary upgrades) over generic conversation filler.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6",
          "msg-7"
        ],
        "quotes": [
          "Update System Instructions: Tell Gemini it is an 'English Learning Companion'."
        ]
      },
      "acceptanceCriteria": [
        "The assistantâ€™s self-description for â€œwho are you / what are youâ€ aligns with â€œEnglish Learning Companionâ€ (not generic â€œAI Friend/Chat Assistantâ€).",
        "Across Friend/Teacher/AI modes, replies consistently focus on English learning (e.g., improved sentence suggestions, grammar tips, vocabulary alternatives) when applicable."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Improve context awareness in chat replies so responses reference the userâ€™s actual message content and provide a specific, helpful next step (answer, correction, example, or targeted follow-up question).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6",
          "msg-7"
        ],
        "quotes": [
          "Context Awareness: It must read the user's message and give a specific, helpful answer."
        ]
      },
      "acceptanceCriteria": [
        "When the user asks a direct question (message contains â€œ?â€), the assistant attempts a direct helpful response first (or asks a targeted clarifying question tied to the userâ€™s topic), rather than replying with a generic â€œtell me moreâ€ prompt.",
        "When the user provides a short statement (<= 3 words), the assistant responds with a helpful expansion prompt that uses the userâ€™s topic (e.g., asking for one concrete detail, offering an example sentence), not a generic filler line.",
        "At least one part of the assistant reply (in all modes) is clearly grounded in the userâ€™s message (e.g., repeats a key noun/verb, proposes a corrected version of what the user wrote, or gives a relevant example)."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Add Hindi/Hinglish detection in the chat assistant and respond in a mixed Hindi + English style when the user message is Hindi/Hinglish (e.g., â€œTum kaun hoâ€), while still supporting English learning goals.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6",
          "msg-7"
        ],
        "quotes": [
          "Language Support: If the user speaks in Hindi/Hinglish (like 'Tum kaun ho'), Gemini should respond in a mix of Hindi and English to explain better."
        ]
      },
      "acceptanceCriteria": [
        "If the user message contains Devanagari text and/or common Hinglish patterns (e.g., â€œTum kaun hoâ€, â€œMujhe help chahiyeâ€), the assistant responds with a blended Hindi+English explanation (not English-only).",
        "For the specific example â€œTum kaun hoâ€, the assistant answers who it is in mixed Hindi+English and includes an English-learning element (e.g., giving the English translation and a natural English alternative like â€œWho are you?â€ / â€œWho are you, exactly?â€).",
        "If the user message is clearly English-only, the assistant responds in English (no unnecessary Hindi mixing)."
      ]
    },
    {
      "id": "REQ-5",
      "text": "Ensure personality modes behave distinctly: Friend Mode should be funny/light, Teacher Mode should be helpful/structured, and both must avoid repetitive templates across messages.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6",
          "msg-7"
        ],
        "quotes": [
          "Personality Check: Make sure 'Friend Mode' is funny and 'Teacher Mode' is helpful, not repetitive."
        ]
      },
      "acceptanceCriteria": [
        "Friend mode replies include light humor/playfulness without becoming repetitive, while still staying focused on English practice.",
        "Teacher mode replies follow a consistent helpful structure (e.g., brief answer or correction + short explanation + 1 example), rather than generic conversation fillers.",
        "Switching between Friend and Teacher for the same user message produces noticeably different tone and structure."
      ]
    }
  ],
  "constraints": [
    "Use English for all user-facing text added/modified as part of this build request output (the app may still produce mixed Hindi+English replies only when the user uses Hindi/Hinglish).",
    "Do not modify files under frontend/src/components/ui or any paths listed as immutable in SYSTEM_CONTEXT."
  ],
  "nonGoals": [
    "Implementing real external Gemini API network calls from the frontend or backend.",
    "Adding new authentication providers or changing Internet Identity integration.",
    "Changing backend canister state/schema for this issue."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}